{
    "contents" : "#' Physical Activity Summary--Sedentary Features\n#'\n#' Summarize sendentary features using proportions and percentiles\n#' @param final_dat cleaned final data that is between record getup time and sleep time\n\n#' @return \\code{total_sed_time} Total sedantary hour, same as PA_summary function output sed_hour\n#' @return \\code{total_number_of_sed_bouts} Total number of sedentary bouts_ It counts the number of sedentary recordings\n#' @return \\code{break_per_day} Number of interrupting sedentary behavior during the given period of time\n#' @return \\code{break_rate} Rate of interrupting sedentary behavior\n#' @return \\code{mean_sed_bout_length} Mean sedentary bout length_ It is the average of the duration time for all sedentary activities\n#' @return \\code{prop_of_sed_time_greater_20min} Proportions of sedentary bout greater than 20 minutes\n#' @return \\code{prop_of_sed_time_greater_60min} Proportions of sedentary bout greater than 60 minutes\n#' @return \\code{prop_of_sed_time_greater_120min} Proportions of sedentary bout greater than 120 minutes\n#' @return \\code{total_sed_time_greater_20min} Total sedentary time greater than 20 minutes\n#' @return \\code{total_sed_time_greater_60min} Total sedentary time greater than 60 minutes\n#' @return \\code{total_sed_time_greater_120min} Total sedentary time greater than 120 minutes\n#' @return \\code{percentile_sed_time_5}  5\\% Percentile of sedentary time\n#' @return \\code{percentile_sed_time_25} 25\\% Percentile of sedentary time\n#' @return \\code{percentile_sed_time_50} 50\\% Percentile of sedentary time\n#' @return \\code{percentile_sed_time_75} 75\\% Percentile of sedentary time\n#' @return \\code{percentile_sed_time_95} 95\\% Percentile of sedentary time\n#' @return \\code{alpha_sed} alpha of sendataty time, see details_\n#' @return \\code{prop_sed_time_6_12} Proportions of sedentary time between 6:00-12:00\n#' @return \\code{prop_sed_time_12_18} Proportions of sedentary time between 12:00-18:00\n#' @return \\code{prop_sed_time_18_22} Proportions of sedentary time between 18:00-22:00\n#' @details Proportions of sedentary bout greater than 20/60/120 minutes is the ratio of the number of sedentary bouts greater than 20/60/120 minutes to the total number of sedentary recordings_\n#' @details Total sedentary time greater than 20/60/120 minutes is the summation of the sedentary durations which are greater than 20/60/120 minutes_\n#' @details To calculate 5\\%/25\\%/___/95\\% percentile of sedentary time, all of the recorded sedentary durations are listed and R function \\emph{quantile} is used to find the percentiles_\n#' @details  alpha_sed is defined by \\code{1+1/M}, where \\code{M} is the average of \\code{log(sedentary bout length /minimum sedentary bout length)}_\n#' @details Proportions of sedentary time between 6:00-12:00/12:00-18:00/18:00-22:00 is the ratio of the sedentary durations to the total activity durations between 6:00-12:00/12:00-18:00/18:00-22:00_\n\n\n#' @examples  data(sample_event);data(sample_bed_time);data(sample_takeon_time);Sedentary_summary(sample_event,sample_takeon_log,sample_bed_time)\n#' @importFrom stats quantile\n#' @export\n\nSedentary_summary=function(final_dat,takeoff.time,bed.time){\n\n#library(reldist)\n\n  final_dat=clean_time(final_dat,takeoff.time)\n  table1=c()\n  record.getup<-bed.time\n  ###\n  record.getup.time<-c()\n  record.sleep.time<-c()\n  for (kk in 1:nrow(record.getup))\n  {\n    temp.getup.time<-as.numeric(as.POSIXlt(strptime(as.character(paste(as.character(record.getup[kk,3] ),as.character(record.getup[kk,4]))),\"%m/%d/%Y %H:%M:%S\"))+2209136400)/24/60/60\n    record.getup.time<-c(record.getup.time,temp.getup.time)\n    temp.sleep.time<-as.numeric(as.POSIXlt(strptime(as.character(paste(as.character(record.getup[kk,5] ),as.character(record.getup[kk,6]))),\"%m/%d/%Y %H:%M:%S\"))+2209136400)/24/60/60\n    record.sleep.time<-c(record.sleep.time,temp.sleep.time)\n  }\n  ###################################################\n  ll=0 #count for getup time\n\n  for (i in unique(final_dat$new_date)){\n    ll=ll+1\n    temp_mat_oneday=final_dat[final_dat$new_date==i,]\n    temp_mat_oneday<-temp_mat_oneday[temp_mat_oneday[,1]>record.getup.time[ll] &temp_mat_oneday[,1]<record.sleep.time[ll], ]\n\n    time_char<-as.POSIXlt(i*24*60*60, origin = ISOdatetime(1899,12,30,0,0,0))\n    month<-as.numeric(format(time_char,\"%m\"))\n    day<-as.numeric(format(time_char,\"%d\"))\n    year<-as.numeric(format(time_char,\"%Y\"))\n  hour_char<-as.numeric(format(as.POSIXlt(temp_mat_oneday$date_time*24*60*60, origin = ISOdatetime(1899,12,30,0,0,0)),\"%H\"))\n  temp_sed<-subset(temp_mat_oneday,temp_mat_oneday$ActivityCode==0)$Interval\n  length_temp_sed<-length(temp_sed)\n  num_changes_from_sed_to_non_sed<- length_temp_sed\n\n  sed_hour<- sum(temp_sed) /60/60\n  length_temp_sed<-length(temp_sed)\n  num_changes_from_sed_to_non_sed<- length_temp_sed\n  total_sed_time<-sed_hour\n  total_number_of_sed_bouts<-num_changes_from_sed_to_non_sed\n  mean_sed_bout_length<- mean(temp_sed) /60/60\n  prop_of_sed_time_greater_20min<- 100*length(temp_sed[temp_sed>20*60])/length_temp_sed\n  prop_of_sed_time_greater_60min<- 100*length(temp_sed[temp_sed>60*60])/length_temp_sed\n  prop_of_sed_time_greater_120min<- 100*length(temp_sed[temp_sed>120*60])/length_temp_sed\n\n  total_sed_time_greater_20min<- sum(temp_sed[temp_sed>20*60])/60/60\n  total_sed_time_greater_60min<- sum(temp_sed[temp_sed>60*60])/60/60\n  total_sed_time_greater_120min<- sum(temp_sed[temp_sed>120*60])/60/60\n\n  quantile_temp<-quantile(temp_sed, probs = c(0.05,0.25,0.5,0.75,0.95))/60/60\n  percentile_sed_time_5<- quantile_temp[1]\n  percentile_sed_time_25<- quantile_temp[2]\n  percentile_sed_time_50<- quantile_temp[3]\n  percentile_sed_time_75<- quantile_temp[4]\n  percentile_sed_time_95<- quantile_temp[5]\n\n  alpha_sed<- 1+ 1/mean(log(temp_sed/ min(temp_sed)))\n  #gini_index_sed<- gini(temp_sed)\n\n  prop_sed_time_6_12<- 100*sum(subset(temp_mat_oneday,temp_mat_oneday$ActivityCode==0 & hour_char>=6 & hour_char<12)$Interval) /(sum(subset(temp_mat_oneday,hour_char>=6 & hour_char<12)$Interval)+0.0001)   ###prevent this value is zero\n  prop_sed_time_12_18<- 100*sum(subset(temp_mat_oneday,temp_mat_oneday$ActivityCode==0 & hour_char>=12 & hour_char<18)$Interval) /(sum(subset(temp_mat_oneday,hour_char>=12 & hour_char<18)$Interval)+0.0001)\n  prop_sed_time_18_22<- 100*sum(subset(temp_mat_oneday,temp_mat_oneday$ActivityCode==0 & hour_char>=18 & hour_char<22)$Interval) /(sum(subset(temp_mat_oneday,hour_char>=18 & hour_char<22)$Interval)+0.0001)\n\n  break_per_day<-num_changes_from_sed_to_non_sed\n  break_rate<-break_per_day/sed_hour\n  table<- cbind(year,month,day,total_sed_time,total_number_of_sed_bouts,break_per_day,break_rate,mean_sed_bout_length,prop_of_sed_time_greater_20min,prop_of_sed_time_greater_60min,prop_of_sed_time_greater_120min,total_sed_time_greater_20min,total_sed_time_greater_60min,total_sed_time_greater_120min,percentile_sed_time_5,percentile_sed_time_25,percentile_sed_time_50,percentile_sed_time_75,percentile_sed_time_95,alpha_sed,prop_sed_time_6_12,prop_sed_time_12_18,prop_sed_time_18_22)\n  row.names(table)=NULL\n  table1=rbind(table1,table)\n  #print(table1)\n\n  }\n  colnames(table1)<- c(\"year\",\"month\",\"day\",\"total_sed_time\",\"total_number_of_sed_bouts\",\"break_per_day\",\"break_rate\",\"mean_sed_bout_length\" ,\"prop_of_sed_time_greater_20min\",\"prop_of_sed_time_greater_60min\",\"prop_of_sed_time_greater_120min\",\"total_sed_time_greater_20min\",\"total_sed_time_greater_60min\",\"total_sed_time_greater_120min\",\"percentile_sed_time_5\",\"percentile_sed_time_25\",\"percentile_sed_time_50\",\"percentile_sed_time_75\",\"percentile_sed_time_95\",\"alpha_sed\",\"prop_sed_time_6_12\",\"prop_sed_time_12_18\",\"prop_sed_time_18_22\")\n\n  #out=list( total_number_of_activity_bouts=total_number_of_activity_bouts,mean_activity_bout_length=mean_activity_bout_length,prop_of_activity_time_greater_5min=prop_of_activity_time_greater_5min,prop_of_activity_time_greater_10min=prop_of_activity_time_greater_10min,prop_of_activity_time_greater_30min=prop_of_activity_time_greater_30min,total_activity_time_greater_5min=total_activity_time_greater_5min,total_activity_time_greater_10min=total_activity_time_greater_10min,total_activity_time_greater_30min=total_activity_time_greater_30min,percentile_activity_time_5=percentile_activity_time_5,percentile_activity_time_25=percentile_activity_time_25,percentile_activity_time_50=percentile_activity_time_50,percentile_activity_time_75=percentile_activity_time_75,percentile_activity_time_95=percentile_activity_time_95,alpha_activity=alpha_activity,stepping_to_standing_ratio=stepping_to_standing_ratio,table=table)\n  return(table1)\n}\n\n",
    "created" : 1454370707384.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1947904119",
    "id" : "7192E347",
    "lastKnownWriteTime" : 1454475722,
    "path" : "C:/Users/Yukun Zhang/Desktop/Yukun/wear/R/Sedentary_summary.R",
    "project_path" : "R/Sedentary_summary.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}