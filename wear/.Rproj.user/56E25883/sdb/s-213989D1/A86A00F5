{
    "contents" : "#' Physical Activity Summary-Summations\n#'\n#' Summarize activity measures\n#' @param final_dat cleaned final data that is between record getup time and sleep time\n#' @return \\code{hours_worn_total} Total worn hours\n#' @return \\code{sed_hour}  Total sedantary hours\n#' @return \\code{stand_hour} Total stand hours\n#' @return \\code{step_hour} Total step hours\n#' @return \\code{num_changes_from_sed_to_non_sed} Numbers of changing from sedantary to non sadantary status\n#' @return \\code{step_count_total} Total Step count\n#' @return \\code{num_hour_over_3_METs} Number of hours that Metabolic Equivalent of Task (MET) is over 3\n#' @return \\code{MET_hours}  Total METs\n#' @return \\code{table} A table that shows all above results\n#' @details All numbers are calculated in the given time period (day, hour, etc_)_ Total sedentary/standing/stepping hours are obtained from the summation of the duration times for sedentary/standing/stepping activities in the given time period_\n\n#' @examples  data(sampledata);PA_summary(sampledata)\n#' @export\nPA_summary=function (final_dat) {\n\n  dat=final_dat\n  final_dat=clean_time(dat)\ntable1=c()\n      ###################################################\n  for (i in unique(final_dat$new_date)){\n    final_dat_oneday=final_dat[final_dat$new_date==i,]\n    final_dat<-subset(final_dat,final_dat[,1]>record.getup.time[ll] & final.dat[,1]<record.sleep.time[ll] )\n    \n  time_char<-as.POSIXlt(i*24*60*60, origin = ISOdatetime(1899,12,30,0,0,0))\n\n  #hour_char<-as.numeric(format(as.POSIXlt(temp_mat$date_time*24*60*60, origin = ISOdatetime(1899,12,30,0,0,0)),\"%H\"))\n  ###\n  temp_sed<-subset(final_dat_oneday,final_dat_oneday$ActivityCode==0)$Interval\n  length_temp_sed<-length(temp_sed)\n  month<-as.numeric(format(time_char,\"%m\"))\n   day<-as.numeric(format(time_char,\"%d\"))\n   year<-as.numeric(format(time_char,\"%Y\"))\n  hours_worn_total<- sum(final_dat_oneday$Interval)/60/60\n  #hours_awake<- (record_sleep_time[ll]-record_getup_time[ll])*24\n  sed_hour<- sum(temp_sed) /60/60\n  stand_hour<- sum(subset(final_dat_oneday,final_dat_oneday$ActivityCode==1)$Interval) /60/60\n  step_hour<- sum(subset(final_dat_oneday,final_dat_oneday$ActivityCode==2)$Interval) /60/60\n  num_changes_from_sed_to_non_sed<- length_temp_sed\n  ######## Code update here !\n  step_count_total<- 2*nrow(subset(final_dat_oneday,final_dat_oneday$ActivityCode==2))  ##### in the event file, one row with ActivityCode==2 means two steps\n  ########\n # gini_index<- gini(temp_sed)\n  num_hour_over_3_METs<-  sum(final_dat_oneday$Interval[(final_dat_oneday$METs/final_dat_oneday$Interval)*60*60>3])/60/60\n  MET_hours<- sum(final_dat_oneday$METs)\n  #valid_day<-ifelse( (hours_worn_total<10 & hours_worn_total/hours_awake>0_8 & step_count_total>200) | (hours_worn_total>=10 & step_count_total>200 ),1,0    )\n  dayofweek<-as.numeric(format(time_char,\"%w\"))\n  weekday_or_weekend<- ifelse( dayofweek!=0 & dayofweek!=6,1,0)\n  #table1<-c(person,group_char,www,month,day,year,hours_worn_total,hours_awake,sed_hour,stand_hour,step_hour,num_changes_from_sed_to_non_sed,step_count_total,num_hour_over_3_METs,MET_hours,valid_day,dayofweek,weekday_or_weekend)\n   table<-cbind(year,month,day,dayofweek,weekday_or_weekend,hours_worn_total,sed_hour,stand_hour,step_hour,num_changes_from_sed_to_non_sed,step_count_total,num_hour_over_3_METs,MET_hours)\n  #print(table)\n\n  table1=rbind(table1,table)\n\n  }\n\n  colnames(table1)<-c(\"year\",\"month\",\"day\",\"dayofweek\",\"weekday_or_weekend\",\"hours_worn_total\",\"sed_hour\",\"stand_hour\",\"step_hour\",\"num_changes_from_sed_to_non_sed\",\"step_count_total\",\"num_hour_over_3_METs\",\"MET_hours\")\n\n # table<-cbind(year,month,day,dayofweek,weekday_or_weekend,hours_worn_total,sed_hour,stand_hour,step_hour,num_changes_from_sed_to_non_sed,step_count_total,num_hour_over_3_METs,MET_hours)\n  #colnames(table)<-c(\"year\",\"month\",\"day\",\"dayofweek\",\"weekday_or_weekend\",\"hours_worn_total\",\"sed_hour\",\"stand_hour\",\"step_hour\",\"num_changes_from_sed_to_non_sed\",\"step_count_total\",\"num_hour_over_3_METs\",\"MET_hours\")\n\n  #out=list(year=year,month=month, day=day,dayofweek=dayofweek, weekday_or_weekend,hours_worn_total=hours_worn_total, sed_hour=sed_hour, stand_hour=stand_hour, step_hour=step_hour, num_changes_from_sed_to_non_sed=num_changes_from_sed_to_non_sed,step_count_total=step_count_total,num_hour_over_3_METs=num_hour_over_3_METs,MET_hours=MET_hours,table=table)\n\n  #table1_label<-c(\"id\",\"group\",\"week\",\"month\",\"day\",\"year\",\"hours_worn_total\",\"hours_awake\",\"sed_hour\",\"stand_hour\",\"step_hour\",\"num_changes_from_sed_to_non_sed\",\"step_count_total\",\"num_hour_over_3_METs\",\"MET_hours\",\"valid_day\",\"dayofweek\",\"weekday_or_weekend\")\n  #num_hour_over_3_METs=num_hour_over_3_METs\n  return(table1)\n}\n",
    "created" : 1453848638049.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2587648221",
    "id" : "A86A00F5",
    "lastKnownWriteTime" : 1453841990,
    "path" : "C:/Users/yk/Desktop/wear/wear/R/PA_summary.R",
    "project_path" : "R/PA_summary.R",
    "properties" : {
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "type" : "r_source"
}